# synchronized原理

​	synchronized通过Monitor实现线程同步，Monitor是线程私有的数据结构，Monitor依赖于底层操作系统的Mutex Lock来实现线程同步。JDK6中为了减少释放锁和占有锁的时间，引入了偏向锁，和轻量级锁优化synchronized；

​	**锁升级过程：无锁 -> 偏向锁 -> 轻量级锁 -> 重量级锁** 

## 无锁

​	无锁就是没有对共享资源进行锁定，所有的线程都能访问并修改同一个资源，但同时只能有一个线程修改成功。无锁修改共享资源时，是在一个循环中进行的，线程会不断尝试修改共享资源，如果没有冲突就修改成功并退出，否则就会继续循环尝试。如果有多个线程修改同一个值，每次必定会有一个线程修改成功，其他线程不断尝试直到成功。

## 偏向锁

​	偏向锁是指一个共享资源多次被同一线程获取，那么该线程自动获取锁，降低获取锁的代价。因为在大多数情况下，锁总是被同一线程多次获得，不存在线程竞争。

## 轻量级锁

​	当锁是偏向级锁时，又有别的线程来获取锁，这时会升级会轻量级锁，也就是自旋锁，来尝试获取锁的线程不会被阻塞，而是继续等待尝试获取锁。当尝试超过一定次数，或者有别的线程也来获取锁的时候，就会升级为重量级锁

## 重量级锁

​	互斥锁，尝试获取锁的线程被阻塞。